import highlight from '@mdx-deck/themes/syntax-highlighter-prism'

import Slide from "../templates/slide"
import ImageSlide from "../templates/image-slide"
import CodeBlock from "../components/site-chrome/code-figure"
import AccessibleAnimationDemo from "../components/better/animation"
import Autocomplete from "../components/better/downshift-autocomplete"

import baseTheme from '../theme'
export const themes = [baseTheme, highlight]
const openModal = () => {
    document.querySelector('.modal-curtain').removeAttribute('hidden')
}
const buttonAction = () => {
    alert('Button clicked')
}

<Slide>

# Construyendo Sitios<br />Accesibles con Gatsby

</Slide>

---

<Slide>

<div style="margin-top: -3em">
    <h1>Quienes somos?</h1>
</div>

<div style="position: relative; margin:0 auto; max-width: 800px;text-align:center;">   
    <img src="../rob.png" alt="Roberto Remedios" style="max-height: 800px; max-width: 300px; margin: 100px 20px; border-radius:50%;float:left; box-shadow: 10px 5px 5px grey; border:solid 10px #000;" />
    <img src="../puas.png" alt="Alfredo Navas" style="max-height: 800px; max-width: 300px; margin: 100px 20px; border-radius:50%;float:right; box-shadow: 10px 5px 5px grey; border:solid 10px #000;" />
</div>
<p style="margin: 0;">
    <a href="https://twitter.com/remediosgraphic">@remediosgraphic</a>&nbsp;~&nbsp;<a href="https://robertoremedios.com">robertoremedios.com</a>
    <a href="https://twitter.com/3LPU4S">@3LPUAS</a>&nbsp;~&nbsp;<a href="https://elpuas.com">elpuas.com</a>
</p>

</Slide>

---

<Slide>

# Accesibilidad

Hacer que la web sea m√°s inclusiva <br />
**_con_** _y_ **_para_ personas con discapacidad**

http://bit.ly/microsoft-inclusive-toolkit

</Slide>

---

<Slide>

# Gatsby Sites

- Server-side render de p√°ginas HTML
- "Hidrataci√≥n" en las aplicaciones React.js
- Enrutamiento autom√°tico del lado del cliente
- Perfecto para herramientas de prueba modernas

https://www.gatsbyjs.org/docs/glossary

</Slide>

---

<Slide>

<img style="height: 90vh; margin-top: -1em;" src="../how-gatsby-works.png" alt="C√≥mo funciona Gatsby" />

</Slide>

---

<Slide>

# Lo que cubriremos

<div style="font-size: 2.2rem;">

- Conceptos b√°sicos de Gatsby
- Debugging de accesibilidad
- Accesibilidad en los sitios de Gatsby
     - Focus management
     - Anuncios
     - Enrutamiento del lado del cliente
     - HTML sem√°ntico
     - Movimientos discretos
     - Mejora progresiva
- Pruebas automatizadas y linting

</div>

</Slide>

---

<Slide>

# Construyendo Bloques<br />con Gatsby

- [Gatsby API Files](https://www.gatsbyjs.org/docs/api-files/)
- [GraphQL Data Layer](https://www.gatsbyjs.org/docs/graphql-concepts/)
- [Creating Pages](https://www.gatsbyjs.org/docs/creating-and-modifying-pages/)
- [Plugins, Themes & Starters](https://www.gatsbyjs.org/docs/plugins-themes-and-starters/)
- [Linking Between Pages](https://www.gatsbyjs.org/docs/linking-between-pages/)
- [Deployment & Hosting](https://www.gatsbyjs.org/docs/deploying-and-hosting/)

</Slide>

---

<div>
    <a href="https://gatsbyjs.org/docs/cheat-sheet/" target="_blank">
        <img src="../cheat-sheet_page_1.png" alt="Gatsby Cheat Sheet p√°gina 1" style="max-height: 100vh" />
    </a>
</div>

---

<div>
    <a href="https://gatsbyjs.org/docs/cheat-sheet/" target="_blank">
        <img src="../cheat-sheet_page_2.png" alt="Gatsby Cheat Sheet p√°gina 2" style="max-height: 100vh" />
    </a>
</div>

---

<Slide>

<div style="margin-top: -4em">

# El app que desarrollaremos hoy

</div>

- Construido con Gatsby y React
- Server and client-rendered
- Produce p√°ginas HTML por defecto
- Incluye estas diapositivas MDX-Deck


<div style="display: inline-block;
    max-width: 45%;
    margin: 0.5em auto 0px;
    text-align: center;
    width: 100%;
    position: absolute;
    left: 25%;">

<img src="../gatsby-icon.png" alt="Gatsby" style="max-width: 47%;margin-right: 0.25em;" />
<img src="../react-logo.png" alt="React" style="max-width: 47%;" />

</div>

</Slide>

---

<Slide>

<div style="margin-top: -2em">

# Instalaci√≥n

Node.js 12+ (recomendado)

</div>

https://github.com/remediosaraya/gatsby-a11y-workshop

<CodeBlock>

```shell
sudo npm install -g gatsby-cli

gatsby new gatsby-workshop https://github.com/remediosaraya/gatsby-a11y-workshop.git
cd gatsby-workshop

gatsby develop
```

</CodeBlock>

Para verlo localmente: http://localhost:8000

Online: https://gatsby-a11y-workshop-1375362427.gtsb.io/

</Slide>

---

<img src="../vscode-tour.png" alt="Proyecto en VS Code" style="max-height: 100vh" />

---

![GraphiQL explorer for this app](../graphiql.png)

---

<Slide>

# Hablemos de <br />herramientas de accesibilidad

‚öí

- [NVDA](https://nvaccess.org/download) (Windows)
- [axe extensions](https://deque.com/axe)
- [Accessibility Insights](https://accessibilityinsights.io)

</Slide>

---

<Slide>

# Cual.js?

- Gatsby + React
- Ember
- Angular
- Polymer
- Vue
- Svelte
- Vanilla

</Slide>

---

<Slide>

# No importa.
## Las personas solo quieren usar su sitio

![Elmo](../elmo-shrug.gif)

</Slide>

---

<Slide>

# Pruebas de #A11y

- Renderizar en un navegador web
- Controles de prueba con el teclado
- Use extensiones web de accesibilidad
- Verificar contraste de color
- Prueba con lectores de pantalla
- Usar zoom %200

</Slide>

---

<Slide width="full">

# Aplicaciones para probar

<div style="float: right; font-size: 6rem; margin: 2rem 2rem 0 0;">
    <span aria-label="magnifying glass" role="img">üîç</span>
</div>

- [Slack JSON file viewer](https://gatsbyjs.slack.com/files/U964CL6GZ/FKPT589U4/feedback-with-comments.json?origin_team=T6VN36NMP)
- [GitHub](https://github.com)
- [Google Maps](https://www.google.com/maps)

</Slide>

---

<Slide>

# Probando esta aplicaci√≥n Gatsby
Inicie una compilaci√≥n en un navegador y comience a probar

<CodeBlock side="left">

```shell
$ gatsby develop
```

<p style="display:inline-block; margin-top:2rem; text-align:left;">
    <small>
        <a href="http://localhost:8000">http://localhost:8000</a><br />
        <a href="http://localhost:8000">http://localhost:8000/__graphql</a>
        </small>
</p>

</CodeBlock>

<CodeBlock side="split">

vs.&nbsp;

</CodeBlock>

<CodeBlock side="right">

```shell
$ gatsby build && gatsby serve
```

<p style="margin-top:2rem;">
    <small><a href="http://localhost:9000">http://localhost:9000</a></small>
</p>

</CodeBlock>

</Slide>

---

<Slide>

# Hidden vs. Visible CSS

<div>
    <button class="demo-button">Demo button</button>
</div>

<CodeBlock side="left">

```css
.visually-hidden { 
	border: 0;
	clip: rect(0 0 0 0);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
}
```

</CodeBlock>

<CodeBlock side="right">

```css
.opacity {
	opacity: 0;
}
.displayNone {
	display: none;
}
.visibility {
	visibility: hidden;
}
```

</CodeBlock>

</Slide>

---

<Slide>

# Accessibility tree

## Una estructura paralela al DOM

Utiliza el API de accesibilidad de la plataforma para comunicar la estructura y el contenido de la p√°gina <br /> a las tecnolog√≠as de asistencia

![Chrome accessibility tree dump](../chrome-accessibility-tree.png)

</Slide>

---

<Slide>

# Que es la plataforma de<br /> APIs de accesibilidad?

https://www.smashingmagazine.com/2015/03/web-accessibility-with-accessibility-api/

</Slide>

---

<Slide>

# Visualizar con el navegador DevTools

El marcado sem√°ntico y los estilos CSS afectan el accessibility tree (√°rbol de accesibilidad)

![Chrome DevTools accessibility inspector](../chrome-a11y-inspector.png)

</Slide>

---

<Slide>

# Focus testing haxx

## Pegar en la consola del navegador (devTools)

<CodeBlock>

```js
document.body.addEventListener('focusin', (event) => {
    console.log(document.activeElement)
})
```

</CodeBlock>

</Slide>

---

<Slide>

# Safari, esta o no enfocando?

<p><img src="../safari-settings.png" alt="Safari Preferences" style="max-width: 70%;" /></p>

</Slide>

---

<Slide>

# Ejercicio 1
## Probar p√°ginas con el teclado

![a wooden doll thing repeatedly hitting a keyboard](../keyboard.gif)

</Slide>

---

<Slide>

# Ejercicio 2
## Corra las extensiones del browser

- [ANDY] (https://www.ssa.gov/accessibility/andi/help/install.html)
- [axe](https://deque.com/axe)
- [Accessibility Insights](https://accessibilityinsights.io)
- [Lighthouse](https://developers.google.com/web/tools/lighthouse/)
- [WAVE](https://wave.webaim.org/extension/)
- [NoCoffee](https://chrome.google.com/webstore/detail/nocoffee/jjeeggmbnhckmgdhmgdckeigabjfbddl?hl=en-US)

</Slide>

---

<Slide>

# Ejercicio 3
## Prueba con accesibilidad devTools

- [Selector de color de Chrome y panel de accesibilidad](https://developers.google.com/web/tools/chrome-devtools/accessibility/reference#pane)
- [Firefox accessibility tools](https://developer.mozilla.org/en-US/docs/Tools/Accessibility_inspector#Accessing_the_Accessibility_Inspector)

</Slide>

---

<Slide>

# Prueba con lectores de pantalla

Hojas de trucos para comenzar
- https://webaim.org/articles/voiceover/
- https://webaim.org/articles/nvda/
- https://webaim.org/articles/jaws/

</Slide>

---

<Slide>

# Ejercicio 4
## Prueba de lector de pantalla

- OSX Voiceover y Safari
- NVDA y Firefox Windows
- JAWS e IE11 o Edge
- iOS Voiceover y Safari
- Accesibilidad de Android y Chrome
- Orca en Linux

</Slide>

---

<Slide>

# Aumento Zoom
## Para usuarias con baja visi√≥n.

- Zoom del navegador (hasta el final: ¬°500%!)
- Zoom a nivel del sistema operativo
- ZoomText y otra tecnolog√≠a de asistencia

</Slide>

---

<Slide>

# Ejercicio 5
## Prueba con aumento

Cosas a tener en cuenta:

- Desplazamiento de p√°gina
- Tama√±os de fuente y escala
- UX de interacciones al hacer zoom

</Slide>

---



<Slide>

# Componentes<br />en Gatsby

- [page components](https://www.gatsbyjs.org/docs/building-with-components/#page-components)
- [non-page components](https://www.gatsbyjs.org/docs/building-with-components/#non-page-components)
- [layout components](https://www.gatsbyjs.org/docs/layout-components/)

<br />
<a href="https://www.gatsbyjs.org/docs/building-with-components/">componentes construidos</a>

</Slide>

---

<Slide>

# Componentes funcionales en acci√≥n.

<CodeBlock side="left" title="src/components/my-component.jsx">

```jsx
import React, {useRef} from 'react'

const MyComponent = (props) => {
    return (
        <div>
            {/* UI stuff here */}
        </div>
    )
}

export default MyComponent
```

</CodeBlock>

<CodeBlock side="right" marginClass="noRightMargin" title="src/pages/index.jsx">

```jsx
import React from 'react'
import { Link } from "gatsby"
import MyComponent from '../components/my-component'
export default () => {
    return (
        <div>
            <Link to="/some-page">Some page</Link>
            <MyComponent />  
        </div>
    )
}
```

</CodeBlock>

</Slide>

---

import TacoComponent from '../components/taco-component'

<Slide>

# Class components

<CodeBlock side="left">

```jsx
import React, {Component} from 'react'

class TacoComponent extends Component {
    constructor(props) {
        super()
        this.tacoTopping = props.topping
    }
    getTacos() {
        if (window)
            window.alert(`TACOS! üåÆ${this.tacoTopping}`)
    }
    render () {
        return (
            <button onClick={() => { this.getTacos()}}>
                Get tacos
            </button>
        )
    }
}
export default TacoComponent
```

</CodeBlock>

<CodeBlock side="right">

```jsx
<TacoComponent topping="üå∂" />
```

<TacoComponent topping="üå∂" />

</CodeBlock>

</Slide>

---

<Slide>

# Accesibilidad en aplicaciones JavaScript (y sitios Gatsby)

<div style="width: 55%; margin: 1em auto">

- Anuncios en vivo de la regi√≥n
- Gesti√≥n del enfoque
- HTML sem√°ntico
- Movimiento discreto
- Mejora progresiva

</div>

</Slide>

---

<Slide>

# Manejo de enfoque

_Mover el foco del usuario como parte de una interacci√≥n <br/> para alertarlo sobre nuevo contenido_

_Tambi√©n: manejo del foco en partes deshabilitadas y mutadas de la p√°gina_

</Slide>

---

<Slide>

Gesti√≥n del enfoque <br /> bloques de construcci√≥n

- Elementos accesibles y operables
- TAB, escape y teclas de flecha
- Estilos de enfoque visibles
- Contenido oculto / inerte

</Slide>

---

<Slide>

# tabindex en HTML

Hacer elementos no interactivos enfocables

<div class="demo-button">
    Demo DIV
</div>

<CodeBlock>

```javascript
tabIndex="0"        // in the tab order. see following slides
tabIndex="-1"       // focusable by script, or removes from tab order
tabIndex="99641"    // all up in your tab order. hard to manage
```

</CodeBlock>

<div style="margin-top:3rem;">
<span role="img" title="light bulb">üí°</span> <em>Los lectores de pantalla van m√°s all√° de la tecla TAB</em>
</div>

</Slide>

---

<Slide>

# tabindex + role + name

Exponer informaci√≥n de accesibilidad para elementos enfocables.

<div>
    <div class="demo-button" tabindex="0">
        Demo DIV
    </div>
</div>

<CodeBlock side="left" marginClass="noRightMargin">

```html
<div tabIndex="0"
     role="button"
     aria-label="Cerrar">   
</div>
```

</CodeBlock>

<CodeBlock side="right">

```js

// focusable
// a button widget, not a DIV
// an accessible name
 
```

</CodeBlock>

<div style="margin-top:3rem;">

<span role="img" title="light bulb">üí°</span> <em>Destinado a elementos interactivos personalizados, no DIVs contenedores</em>

</div>

</Slide>

---

<Slide>

# tabindex + role + name + events

Haga controles personalizados totalmente interactivos

<div>
    <div class="demo-button" tabindex="0" aria-label="Close" role="button">
        DIV button
    </div>
</div>

<CodeBlock side="left">

```jsx
<div tabIndex="0"
     role="button"
     aria-label="Close"
     onClick={clickHandler}
     onKeyDown={keydownHandler}>   
</div>
```

</CodeBlock>


<CodeBlock side="right">

```jsx
// or just use a button :)
<button aria-label="Close"
        onClick={clickHandler}>   
</button>
```

</CodeBlock>

</Slide>

---

<Slide>

# ARIA: <br /> aplicaciones de Internet enriquecidas accesibles

https://www.w3.org/TR/wai-aria-1.1/

- ** rol **: ¬øqu√© es?
- ** estado **: ¬øqu√© le est√° pasando?
- ** propiedad **: ¬øcu√°l es su naturaleza?

La primera [regla de ARIA] (https://www.w3.org/TR/using-aria/) es _no la use_

</Slide>

---

<Slide>

# Capas modales: <br /> deshabilitar el contenido de fondo

<div>
    <button class="demo-button" onClick={openModal}>Open curtain</button>
    <div style="display: inline-block; margin-left: 1em;">
        <a href="#">Demo link</a>
    </div>
</div>

- `aria-hidden="true"` and `tabindex="-1"`
- `inert` (+ [polyfill](https://github.com/WICG/inert))
- CSS `display: none`
- `aria-modal`*

<div class="modal-curtain" hidden></div>

</Slide>

---

<Slide>

# Patrones de gesti√≥n del enfoque <br />

- men√∫s desplegables y men√∫s
- Capas y modales
- Ver cambios y eliminaciones
- Pantallas de carga

</Slide>

---

<Slide>

# Interacciones de widgets: <br /> teclas de flecha o no?

Depende de la funci√≥n y el patr√≥n. <span role="img" title="sparkle">‚ú®</span>

http://w3c.github.io/aria-practices/

</Slide>

---

<Slide>

# Navegaci√≥n vs. Acciones
## a.k.a. Enlaces vs. Botones

<div>
<a href="#">Link</a> <button class="demo-button" onClick={buttonAction}>Button</button>
</div>

<CodeBlock side="left">

```html
<a href="/page">Page</a>
<Link to="/page">Page</Link>
```

</CodeBlock>

<CodeBlock side="right">

```jsx
<button onClick={action}>Thing</button>
```

</CodeBlock>

https://marcysutton.com/links-vs-buttons-in-modern-web-applications

</Slide>

---

<Slide>

# Estilos de enfoque visibles
√ötil para tantas personas y situaciones, pero a menudo desactivado para todos

<div>
<button class="demo-button no-focus">Demo button</button>
</div>

<CodeBlock side="left" title="üö´ don‚Äôt">

```css
*:focus {
    outline: none;
}
```
</CodeBlock>

<CodeBlock side="right" title="‚úÖ do">

```css
:hover, :focus {
   /* interaction styles here  */
   outline: 5px auto blue;
}
```
</CodeBlock>

</Slide>

---

<Slide>

<div style="margin-top: -2em">

# Modalidades de entrada de estilo

</div>

<div>
<button class="demo-button">Demo button</button>
</div>

<CodeBlock side="left" title=":focus-visible + polyfill" url="https://github.com/WICG/focus-visible">

```css
:focus:not(.focus-visible) {
	outline: 0;
 }
 :focus-visible {
	outline: 3px solid blue;
 }
```
</CodeBlock>

<CodeBlock side="right" title="What Input.js" url="https://github.com/ten1seven/what-input">

```js
// in a layout or component
import 'what-input'
```

```css
/* in your CSS */
[data-whatintent='mouse'] *:focus {
  outline: none;
}
```
</CodeBlock>

_Una preferencia a nivel de sistema operativo ser√≠a ideal_ üëç

</Slide>

---

<Slide>

<div style="margin-top: -3em">

# CSS-in-JS
</div>

Cached class names aren't user friendly, e.g. `class="sc-bdVaJa"`

<CodeBlock side="center" title="Styled Components" url="https://codepen.io/marcysutton/pen/MRxxyM?editors=1010">

```jsx
import React from 'react'
import { styled } from 'styled-components'
const MegaHeader = styled.header`
    background-color: rebeccapurple;
`
const Layout = () => (
    // add a stable CSS class
    <MegaHeader className={`site-wrap`}>
        <h1>My Gatsby Site</h1>
    </MegaHeader>
)
```

</CodeBlock>

</Slide>

---

<Slide>

# Focus management<br />patterns: underlying tech

- Access DOM nodes with [React refs](https://reactjs.org/docs/refs-and-the-dom.html)
- New: [React FocusScopes](https://twitter.com/devongovett/status/1100829054800846848)
- [Vue.js $refs](https://vuejs.org/v2/api/#vm-refs)

</Slide>

---

<Slide>

# Dropdown Demo

http://localhost:8000/dropdown

</Slide>

---

<Slide>

# Exercise
## Create an accessible dropdown

- Component shell: [dropdown.js](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/src/components/better/dropdown.js)

</Slide>

---

<Slide>

# Exercise answer

- [examples/dropdown](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/examples/dropdown/)

</Slide>

---

<Slide>

# Announcements using<br />ARIA Live Regions

![BBC GIF with a young girl with a megaphone saying attention please](../announcement.webp)

</Slide>

---

<Slide>

# Announcement patterns
Notify assistive tech users without moving focus

- Asynchronous save / update / etc.
- Combobox usage / list filtering
- Chat widgets
- Title changes

</Slide>

---

<Slide>

# ARIA Live Regions
Message command centers of varying importance

https://www.w3.org/TR/wai-aria/#live_region_roles

<CodeBlock side="left">

```html
<div role="status"></div>
<div role="alert"></div>
```

</CodeBlock>

<CodeBlock side="right">

```html
<div aria-live="polite"></div>
<div aria-live="assertive"></div>
```

</CodeBlock>


</Slide>

---

<Slide>

# Live Region Example

<div class="demo">
    <Autocomplete />
</div>

<div style="margin-top:2em;">
    <a href="https://github.com/downshift-js/downshift">Downshift.js</a>
</div>

</Slide>

---

<Slide>

# Live Region Gotchas & Tips

- Include [multiple regions](https://github.com/dequelabs/ngA11y) for stubborn situations
- Politeness levels depend on the use case
- Site-level announcement manager APIs <span role="img" aria-label="thumbs up">üëç</span>

https://github.com/AlmeroSteyn/react-aria-live

</Slide>

---

<Slide>

# Live region demo

http://localhost:8000/announcer

</Slide>

---

<Slide>

# Exercise
## Build a live region

- [live-region](https://github.com/remediosaraya/gatsby-a11y-workshop/tree/master/src/components/better/live-region.js)

</Slide>

---

<Slide>

# Exercise answer
## Live region

- [examples/live-region](https://github.com/remediosaraya/gatsby-a11y-workshop/tree/master/examples/live-region)

</Slide>

---

<Slide>

<div style="margin-top: -2em">

# Client-side routing

Navigation where JavaScript controls browser history<br />and dynamically maps URLs to each page or view

![Animation of Grommet sorting letters](../mail.gif)

[User testing research on the Gatsby blog](https://www.gatsbyjs.org/blog/2019-07-11-user-testing-accessible-client-routing/)

</div>

</Slide>

---

<Slide>

# Gatsby + @reach/router

- Automatic client-routing
- Focus management
- [Recent improvements in Gatsby core](https://github.com/gatsbyjs/gatsby/pull/19290)

</Slide>

---

<Slide>

# A11y routing research

- A small UI control in each view target, like a skip link
- Label with its action, e.g. "skip to navigation"
- When a user clicks a nav link, move focus to this control
- Use a Live Region to announce page change*

![focus diagram](../focus-diagram.png)

</Slide>

---

<Slide>

# Responsive design<br />is good for accessibility

<img alt="zoomed-in view of a desktop prototype" src="../magnification-a11y.png" style="margin-top: 1em; max-height: 500px;" />

</Slide>

---

<Slide>

# Client-side routing demo

http://localhost:8000

</Slide>

---

<Slide>

# Exercise
## Focus on client-side route change

- Use Gatsby's [`onRouteUpdate` method](https://www.gatsbyjs.org/docs/browser-apis/#onRouteUpdate)
- Send focus to skip link
- Announce page in ARIA Live Region

</Slide>

---

<Slide>

# Exercise answer
## Client-side routing

- Gatsby component: [examples/client-side-routing](https://github.com/remediosaraya/gatsby-a11y-workshop/tree/master/examples/client-side-routing)    

</Slide>

---

<Slide>

# Semantic HTML ‚ú®

- Use headings & landmarks
- Start with native UI controls
- Build semantics into templates
- Verify assistive tech output

[WebAIM: Semantic Structure](https://webaim.org/techniques/semanticstructure/)

</Slide>

---

<Slide>

# Why semantics are important

> _Headings save time, and programattic information is useful_

<p style="max-width: 80%; margin: 0 auto;">
Semantic HTML communicates what's on a page to users of assistive technology, reader modes, conversational UIs, search engines, and more
</p>

</Slide>

---

<Slide header="false">

<div class="visually-hidden">
# Semantics IRL
</div>

![An Event Apart homepage in Chrome DevTools](../aea-grid-inspect.png)

</Slide>

---

<Slide>

# Native HTML vs. ARIA

Implicit and explicit semantics: built-in vs. bolt-on

<CodeBlock side="left">

```html
<header aria-label="Global">
<footer aria-label="Global">
```

</CodeBlock>

<CodeBlock side="right">

```html
<div role="banner" aria-label="Global">
<div role="contentinfo" aria-label="Global">
```

</CodeBlock>

</Slide>

---

<Slide>

# Tools for testing semantics

- [Accessibility Insights: Headings](https://accessibilityinsights.io)
- [Firefox Web Developer Extension](https://addons.mozilla.org/en-US/firefox/addon/web-developer/):<br />_Information > View Document Outline_
- [NVDA heading navigation, elements list](https://dequeuniversity.com/screenreaders/nvda-keyboard-shortcuts#nvda-the_basics)
- [Voiceover rotor](https://dequeuniversity.com/screenreaders/voiceover-keyboard-shortcuts#vo-mac-the-rotor)
- Browser reader modes

</Slide>

---

<Slide>

# Semantics demo

http://localhost:8000/layout

</Slide>

---

<Slide>

# Practice Problem
## Use semantic markup

Add markup to a blank page and test it using Accessibility Insights.

- Gatsby page shell: [pages/semantics.jsx](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/src/pages/semantics.jsx)

</Slide>

---

<Slide>

# Unobtrusive motion

Building safe _and_ delightful interfaces

- `prefers-reduced-motion` CSS
- media, animation playback controls
- opt-in for autoplay

https://source.opennews.org/articles/motion-sick/

</Slide>

---

<Slide>

# Animation demo

<AccessibleAnimationDemo></AccessibleAnimationDemo>

https://codepen.io/marcysutton/pen/yqVVeY

</Slide>

---

<Slide>

# prefers-reduced-motion

<CodeBlock title="CSS" side="left">

```css
@media (prefers-reduced-motion: reduce) {
    .animation {
        animation: none;
        transition: none;
    }
}
```

</CodeBlock>

<CodeBlock title="JavaScript" side="right">

```js
var motionQuery = matchMedia('(prefers-reduced-motion)');
function handleReduceMotionChanged() {
  if (motionQuery.matches) {
    /* adjust 'transition' or 'animation' properties */
  } else { 
    /* standard motion */
  }
}
motionQuery.addListener(handleReduceMotionChanged);
handleReduceMotionChanged(); // trigger once on load
```

</CodeBlock>

[WebKit guide](https://webkit.org/blog/7551/responsive-design-for-motion/) ~ [MDN docs](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-reduced-motion)


</Slide>

---

<Slide>

# reduced-motion demo

http://localhost:8000/animation

</Slide>

---

<Slide>

# Exercise!

Play with reduced-motion and CSS animation or transitions

- [card-flip.js](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/src/components/better/card-flip.js)

</Slide>

---

<Slide>

# Reduced-motion answers

- React: [examples/reduced-motion](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/examples/reduced-motion)
- vanilla.js: https://codepen.io/marcysutton/pen/yqVVeY

</Slide>

---

<Slide>

# Progressive enhancement

Emphasize core web page content first, then add layers of presentation and features on top as browsers/network connections allow

<div style="width: 40%; display: inline-block; margin: 0em auto;">
<ul style="margin-top: 0;">
    <li>Turn off JavaScript</li>
    <li>Provide accessible baseline markup</li>
    <li>Add ARIA with scripting</li>
    <li>Prioritize core user flows</li>
</ul>

</div>

</Slide>

---

<Slide>

# Gatsby & SSR

Output static HTML by default at build time

<CodeBlock>

```bash
gatsby build
```

</CodeBlock>

</Slide>

---

<Slide>

# Gatsby progressive<br />enhancement demo

http://localhost:8000/enhanced-tablist

</Slide>

---

<Slide>

# Exercise!

Play with progressive enhancement

- [tab-list.js](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/src/components/better/tab-list.js)

</Slide>

---

<Slide>

# Exercise answer
## Progressive enhancement

- [Working tab-list.js example](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/examples/progressive-enhancement)

</Slide>

---

<Slide>

# Testing <span role="img" title="test tube">üß™</span>

Improving quality in development

- linting
- unit tests
- integration/end-to-end
- accessibility test APIs
- continuous integration
- manual & user testing

</Slide>

---

<Slide>

# Linting

Testing for quality live in a file or on a commit

[eslint-plugin-jsx-a11y](https://github.com/evcohen/eslint-plugin-jsx-a11y)

- you might need to [reconfigure rules](https://www.gatsbyjs.org/docs/making-your-site-accessible/#linting-with-eslint-jsx-plugin-a11y)
- CSS can have an impact
- rendering makes a difference

</Slide>

---

<Slide>

# Accessibility Units

## component-level API concerns

<p style="font-size: 1.5em;"><span role="img" title="puzzle piece">üß©</span></p>

</Slide>

---

<Slide>

# Unit test approach

- Test code in isolation
- Stub inputs/fixture data
- Often headless
- Fast changing of state

</Slide>

---

<Slide>

# Accessibility unit tests

- Component-specific behavior
- Interaction/focus APIs
- Text alternatives
- ARIA states

Article: [Writing Automated tests for Accessibility](https://www.deque.com/blog/writing-automated-tests-accessibility/)

</Slide>

---

<Slide>

# Unit test demo

- Dropdown with Jest: [\__tests\__](https://github.com/remediosaraya/gatsby-a11y-workshop/tree/master/src/components/better/__tests__)

</Slide>

---

<Slide>

# Exercise

Write an accessibility unit test!

- Jest test shell: [dropdown.test.js](https://github.com/remediosaraya/gatsby-a11y-workshop/tree/master/src/components/better/__tests__/dropdown.test.js)
- https://testing-library.com/docs/dom-testing-library/intro
- https://github.com/testing-library/jest-dom

</Slide>

---

<Slide>

# Exercise answer
## Unit testing

- Jest test: [dropdown.test.js](https://github.com/remediosaraya/gatsby-a11y-workshop/tree/master/examples/unit-testing/dropdown.test.js)

</Slide>

---

<Slide>

# Accessible Pages
## interroperability of components

<p style="font-size: 1.5em;"><span role="img" title="newspaper">üì∞</span></p>

</Slide>

---

<Slide>

# Integration &<br />end-to-end tests

- Real-world browser testing
- Document/page-level rules
- Widget interrop
- Color contrast
- Framework flexibility

</Slide>

---

<Slide>

# [Selenium Webdriver example](https://github.com/marcysutton/axe-webdriverjs-demo)

<CodeBlock>

```js
const WebDriver = require('selenium-webdriver')
 
describe('Keyboard tests', () => {
    let driver = new selenium.Builder().forBrowser('chrome').build()
        driver.get('http://localhost:4000').then(() => done())

    it('should change state with the keyboard', () => {
      var selector = 'span[role="radio"][aria-labelledby="radiogroup-0-label-0"]';

      driver.findElement(selenium.By.css(selector))
        .then((element) => {
            element.sendKeys(Key.SPACE)
            return element
        })
        .then((element) => element.getAttribute('aria-checked'))
        .then((attr) => {
            expect(attr).toEqual('true')
        })
    })
})
```
</CodeBlock>

</Slide>

---

<Slide>

# [Cypress example](https://www.gatsbyjs.org/docs/end-to-end-testing/)

<CodeBlock>

```js
/// <reference types="Cypress" />
describe("Accessibility checks", () => {
  beforeEach(() => {
    cy.visit("/")
    cy.wait(500)
  })
  it("Checks if footer link is focusable and has the correct attributes", () => {
    cy.getAllByText("Gatsby").focus()
    cy.focused()
      .should("have.text", "Gatsby")
      .should("have.attr", "href", "https://www.gatsbyjs.org")
      .should("not.have.css", "outline-width", "0px")
  })
})
```

</CodeBlock>

</Slide>

---

<Slide>

# _No matter what kind of test:<br />focus on the outcome,<br />not the code implementation_ ‚ú®

</Slide>

---

<Slide>

# Using an A11y test API
## Rules you don‚Äôt have to write

<div style="display: inline-block; width: 50%;">

- [axe-core](https://github.com/dequelabs/axe-core)
- [cypress-axe](https://www.npmjs.com/package/cypress-axe)
- [axe-webdriverjs](https://github.com/dequelabs/axe-webdriverjs)

</div>
<div style="display: inline-block; width: 50%; vertical-align: top;">

- [WAVE](https://wave.webaim.org/api/)
- [accessibilityjs](https://github.com/github/accessibilityjs)
- [Lighthouse](https://developers.google.com/web/tools/lighthouse/)*

</div>

</Slide>

---

<Slide>

# What can we automate?

Tests can catch roughly 30-50% of accessibility issues,<br />depending on the rule set

üëâ _Screen readers can‚Äôt be automated_

</Slide>

---

<Slide>

<div style="text-align: left;">
    <h1><em>Write a combination<br />of tests to catch a variety<br />of bugs</em> <span role="img" title="laptop">üíª</span><span role="img" title="magnifying glass">üîé</span><span role="img" title="bug">üêõ</span></h1>
</div>

</Slide>

---

<Slide>

# Integration test demo

[cypress/integration/index.js](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/cypress/integration/index.js)

</Slide>

---

<Slide>

# Exercise!

Write an end-to-end accessibility test for<br />keyboard interactions and/or with an accessibility test API

- Cypress test shell: [index.js](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/cypress/integration/index.js)
- Cypress API docs: https://cypress.io

</Slide>

---

<Slide>

# Integration test answers

- Cypress tests: [examples/integration-testing](https://github.com/remediosaraya/gatsby-a11y-workshop/blob/master/examples/integration-testing)

</Slide>

---

<Slide>

# Continuous Integration

Opportunities to test for accessibility on every commit,<br />pull request, and deployment

https://marcysutton.github.io/a11y-and-ci/

</Slide>

---

<Slide>

# Track who broke the build
https://twitter.com/zqxwzq/status/868039653697482753

<div style="max-width: 65%; margin: 1em auto;">

![A TV monitor with broken build bandits wanted for bounty](../ci-bandits.jpg)

</div>

</Slide>

---

<Slide>

# Spoiler: we need to do more

Automated testing and linting only gets us so far.<br />Projects need manual human testing, too

<span role="img" title="bow in respect">üôá‚Äç‚ôÄÔ∏è</span>

</Slide>

---

<Slide>

# Manual testing advice
From Eric Bailey

https://www.smashingmagazine.com/2018/09/importance-manual-accessibility-testing/

</Slide>

---

<Slide>

# Accessibility<br />User Testing

- [Access Works](https://access-works.com/)
- [Fable Tech Labs](https://www.makeitfable.com/)

https://www.youtube.com/watch?v=Tr21FqQQv-U

</Slide>

---

<Slide>

## Accessibility Resources

- https://www.gatsbyjs.org/docs/making-your-site-accessible/
- https://reactjs.org/docs/accessibility.html

</Slide>

---

<Slide>

# Q & A

</Slide>
